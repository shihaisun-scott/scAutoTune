% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/find_pcs.R
\name{autotune_find_pcs}
\alias{autotune_find_pcs}
\title{Determine optimal number of PCs using LOESS elbow detection
with optional Harmony batch correction.}
\usage{
autotune_find_pcs(
  seurat_obj,
  feature_steps = seq(500, 6000, by = 500),
  max_pcs = 40,
  span = 0.25,
  batch_var = NULL
)
}
\arguments{
\item{seurat_obj}{A Seurat object already loaded into R.}

\item{feature_steps}{Vector of HVG numbers to test.}

\item{max_pcs}{Maximum number of PCs to compute.}

\item{span}{LOESS smoothing span.}

\item{batch_var}{OPTIONAL metadata column name for batch correction
(e.g., "donor"). If provided, Harmony integration is used.}
}
\value{
A list containing:
\itemize{
\item pc_df        – all variance explained curves
\item elbow_df     – curve for chosen HVG count
\item suggested_pcs – LOESS-based elbow estimate
\item plot         – ggplot object
}
}
\description{
Determine optimal number of PCs using LOESS elbow detection
with optional Harmony batch correction.
}
